# Windows启动脚本使用指南

## 快速选择

| 启动方式 | 文件名 | 兼容性 | 推荐度 | 说明 |
|---------|--------|--------|--------|------|
| 🟢 **调试模式** | `start_debug.bat` | ⭐⭐⭐⭐⭐ | ✅ 强烈推荐 | 纯英文，显示详细信息，首次使用推荐 |
| 🟢 **简单启动** | `start.bat` | ⭐⭐⭐⭐⭐ | ✅ 推荐 | 纯英文，快速启动 |
| 🟡 **调试模式（中文）** | `调试模式启动.bat` | ⭐⭐⭐ | ⚠️ 可能有问题 | 可能有编码问题 |
| 🟡 **简单启动（中文）** | `启动.bat` | ⭐⭐⭐ | ⚠️ 可能有问题 | 可能有编码问题 |

## 推荐使用方法

### ✅ 方法1：调试模式启动（最推荐）

```
双击 start_debug.bat
```

**特点**：
- ✅ 纯ASCII字符，100%兼容
- ✅ 显示详细的启动信息
- ✅ 捕获并显示错误
- ✅ 可以查看日志文件
- ✅ 首次使用强烈推荐

**适用场景**：
- 首次使用
- 遇到问题需要调试
- 需要查看详细信息

### ✅ 方法2：简单启动

```
双击 start.bat
```

**特点**：
- ✅ 纯ASCII字符，100%兼容
- ✅ 快速启动
- ✅ 界面简洁

**适用场景**：
- 日常使用
- 程序已验证可以正常工作

## 为什么推荐英文版本？

### 编码问题详解

**问题**：中文bat文件在某些Windows系统上会出现编码错误

```
错误示例：
'录' 不是内部或外部命令，也不是可运行的程序或批处理文件。
```

**原因**：
1. Windows批处理文件默认使用GBK编码
2. 项目使用UTF-8编码保存文件
3. 编码不匹配导致中文字符被错误解析

**解决方案**：
- ✅ 使用纯ASCII字符的bat文件（start.bat / start_debug.bat）
- ✅ 不受任何编码问题影响
- ✅ 在所有Windows系统上都能正常工作

## 文件对比

### start_debug.bat（英文调试版）✅

```batch
@echo off
title Excel Defect Data Analysis Tool - Debug Mode
echo ============================================
echo Excel Defect Data Analysis Tool - Debug Mode
echo ============================================
echo.
echo Starting...
...
```

**优点**：
- 纯ASCII字符
- 显示详细调试信息
- 100%兼容所有Windows系统

### 调试模式启动.bat（中文版）⚠️

```batch
@echo off
chcp 65001 >nul
title Excel缺陷数据统计分析工具 - 调试模式
echo ============================================
echo Excel缺陷数据统计分析工具 - 调试模式
echo ============================================
...
```

**缺点**：
- 包含中文字符
- 在某些系统上可能出现编码问题
- 依赖系统UTF-8支持

## 故障排除

### 问题1：编码错误

**症状**：
```
'录' 不是内部或外部命令
```

**解决**：
使用 `start.bat` 或 `start_debug.bat`（英文文件名）

### 问题2：找不到程序文件

**症状**：
```
ERROR: Program file not found
```

**解决**：
1. 确保在正确的目录（包含excel-draw-tool.exe）
2. 检查是否完整解压了所有文件

### 问题3：窗口一闪而过

**症状**：
双击bat文件后窗口立即关闭

**解决**：
使用 `start_debug.bat` 查看详细错误信息

### 问题4：端口被占用

**症状**：
```
Port 5000 is occupied
```

**解决**：
程序会自动尝试端口5001-5009，或手动关闭占用5000端口的程序

## 使用流程图

```
解压zip文件
    ↓
查看 START_HERE.txt
    ↓
首次使用？
  ├─ 是 → 双击 start_debug.bat
  │         ↓
  │      查看详细启动信息
  │         ↓
  │      验证程序正常
  │         ↓
  └─ 否 → 双击 start.bat
            ↓
          快速启动
            ↓
    浏览器自动打开
            ↓
        开始使用
```

## 日志和调试

### 日志文件位置

```
logs/
├── app_20260118_103000.log
├── app_20260118_110000.log
└── app_20260118_150000.log
```

每次启动都会创建带时间戳的日志文件

### 查看日志

**方法1：使用start_debug.bat**
- 程序退出后选择查看最新日志

**方法2：手动打开**
```
1. 打开 logs 目录
2. 找到最新的 .log 文件
3. 用记事本打开
```

### 日志内容示例

```
[2026-01-18 10:30:00] ============================================
[2026-01-18 10:30:00] Excel缺陷数据统计分析工具启动中...
[2026-01-18 10:30:00] ============================================
[2026-01-18 10:30:01] 启动Web服务器...
[2026-01-18 10:30:01] 访问地址: http://localhost:5000
[2026-01-18 10:30:01] 日志文件: logs/app_20260118_103000.log
[2026-01-18 10:30:01] ============================================
[2026-01-18 10:30:01] 服务器运行中... 按 Ctrl+C 停止服务
```

## 系统要求

- Windows 7 或更高版本
- 不需要安装Python
- 不需要管理员权限（除非端口被占用）
- 支持完全离线使用

## 技术支持

如果以上方法都无法解决问题：

1. **收集信息**：
   - 使用 `start_debug.bat` 启动
   - 截图错误信息
   - 查看并保存最新日志文件

2. **提供信息**：
   - Windows版本
   - 错误截图
   - 日志文件内容

3. **常见原因**：
   - 端口被占用（自动切换到其他端口）
   - 防火墙阻止（允许访问）
   - 文件不完整（重新解压）
   - 权限不足（以管理员身份运行）

## 总结

| 特性 | 英文版 (start*.bat) | 中文版 (*.bat) |
|------|-------------------|---------------|
| 兼容性 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
| 编码问题 | ✅ 无 | ⚠️ 可能有 |
| 推荐度 | ✅ 强烈推荐 | ⚠️ 备用 |
| 适用场景 | 所有Windows系统 | UTF-8支持好的系统 |

**建议**：优先使用 `start_debug.bat` 或 `start.bat`，功能完全相同，兼容性更好！

---

**快速提示**：解压后直接双击 `start_debug.bat` 即可开始使用！

