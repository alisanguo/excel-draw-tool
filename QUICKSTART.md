# 快速开始指南

## 一键启动（推荐）

### macOS/Linux:
```bash
./start.sh
```

### Windows:
```bash
# 激活虚拟环境
venv\Scripts\activate

# 启动应用
python app.py
```

## 访问应用

启动后，打开浏览器访问: **http://localhost:5000**

---

## 📖 使用流程

### 1️⃣ 上传Excel文件

- 点击上传区域或拖拽文件
- 支持 `.xlsx` 格式
- 文件会自动解析

### 2️⃣ 选择缺陷模块

- 系统自动提取所有缺陷模块
- 默认全选所有模块
- 可以取消选择某些模块来过滤数据

### 3️⃣ 生成图表

- 点击"生成图表"按钮
- 页面实时展示4个统计图表：
  1. **不同状态下的缺陷数量统计**（柱状图）
  2. **缺陷分析归类统计**（饼图）
  3. **缺陷停留时长分析**（柱状图）
  4. **每日新增/修复缺陷情况**（折线图）

### 4️⃣ 交互查看

- 鼠标悬停查看详细数据
- 可以重新选择模块并生成新图表
- 图表支持缩放和交互

---

## 📋 Excel文件要求

### 必需列（5个核心列）

| 列名 | 说明 | 示例 |
|------|------|------|
| 标题 | 缺陷标题 | 用户无法登录 |
| 状态 | 当前状态 | 新建、修复中、待修复、待验证、已关闭 |
| 创建时间 | 创建时间 | 2020-01-13 09:32:46 |
| 缺陷模块 | 所属模块 | 用户模块、订单模块 |
| 缺陷分析类型 | 分析归类 | A类、B类、C类 |

### 可选列（用于修复统计）

| 列名 | 用途 |
|------|------|
| 更新时间 | 用于待验证状态的修复统计 |
| 完成时间 | 用于已关闭状态的修复统计 |

### ⚠️ 特殊规则：状态映射

根据需求，以下状态会统一映射为"待修复"：
- 新建 → 待修复
- 修复中 → 待修复
- 待修复 → 待修复

### 示例数据结构

| 事项ID | 标题 | 状态 | 缺陷模块 | 缺陷分析类型 | 创建时间 | 更新时间 |
|--------|------|------|----------|--------------|----------|----------|
| 55694 | 用户无法登录 | 新建 | 用户模块 | A类 | 2020-01-13 09:32:46 | 2020-01-13 09:35:13 |
| 55693 | 数据显示错误 | 已关闭 | 订单模块 | B类 | 2020-01-12 17:55:07 | 2020-01-13 09:23:27 |

---

## 🧪 测试示例

### 使用内置示例数据

1. 启动应用
2. 上传项目中的 `sample_defect_data.xlsx`
3. 查看自动生成的模块列表（用户模块、订单模块、支付模块等）
4. 点击"生成图表"
5. 查看4个统计图表

### 生成新的示例数据

```bash
source venv/bin/activate
python create_sample_data.py
```

会生成包含50条记录、5个不同模块的示例数据。

---

## 📊 4个统计图表说明

### 图表1: 不同状态下的缺陷数量统计（柱状图）

**位置**：左上角  
**统计规则**：
- 应用状态映射（新建/修复中/待修复 → 待修复）
- 按状态分组，统计 count(标题)

### 图表2: 缺陷分析归类统计（饼图）

**位置**：右上角  
**统计规则**：
- 根据"缺陷分析类型"字段统计
- 圆环饼图显示各类型占比

### 图表3: 缺陷停留时长分析（柱状图）

**位置**：左下角  
**统计规则**：
- **仅统计待修复状态的缺陷**
- 计算：当前日期 - 创建日期（以天为单位）
- 按停留天数分组统计数量

### 图表4: 每日新增/修复缺陷情况（折线图）

**位置**：右下角  
**统计规则**：
- **每日新增**：根据创建时间统计 count(标题)
- **每日修复**：
  - 待验证状态缺陷：使用更新时间
  - 已关闭状态缺陷：使用完成时间
- 双线对比展示趋势

---

## ⚡ 功能特点

### ✅ 模块过滤
- 自动提取所有缺陷模块
- 支持多选（默认全选）
- 支持一键全选/取消全选
- 根据选择动态过滤数据

### ✅ 实时展示
- 不生成Excel文件
- Web页面直接展示图表
- 支持交互式探索

### ✅ 美观图表
- 使用ECharts图表库
- 支持鼠标悬停查看详情
- 响应式设计，自适应窗口大小

---

## ❓ 常见问题

### Q: 图表没有数据或显示不完整？

**检查清单**：
- ✅ Excel包含必需的5个列
- ✅ 列名精确匹配（注意中文）
- ✅ 至少选择了一个模块
- ✅ 数据中没有大量空值

### Q: 缺陷停留时长图表为空？

**原因**：该图表只统计"待修复"状态的缺陷

**解决**：确保数据中有新建、修复中或待修复状态的记录

### Q: 状态统计结果和预期不符？

**原因**：状态映射规则
- 新建、修复中、待修复 → 统一为"待修复"

**解决**：这是按照需求实现的特殊规则

### Q: 每日修复统计不准确？

**原因**：修复统计需要特定字段
- 待验证状态：需要"更新时间"列
- 已关闭状态：需要"完成时间"列

**解决**：确保Excel中包含这些列

### Q: 如何修改端口号？

编辑 `app.py` 最后一行：
```python
app.run(debug=True, host='0.0.0.0', port=5000)  # 修改port参数
```

### Q: 如何在局域网访问？

启动后，使用本机IP地址访问：
```
http://192.168.1.100:5000
```

查看IP：
```bash
# macOS/Linux
ifconfig | grep "inet "
```

---

## 🔧 手动安装依赖

如果自动安装失败：

```bash
# 激活虚拟环境
source venv/bin/activate  # macOS/Linux
# 或
venv\Scripts\activate     # Windows

# 安装依赖
pip install -r requirements.txt
```

---

## 📦 依赖包

- Flask 3.1.2 - Web框架
- Pandas 2.3.3+ - 数据处理
- openpyxl 3.1.5 - Excel读取

前端使用CDN引入ECharts 5.4.3

---

## 🚀 性能提示

- 建议文件大小不超过16MB
- 数据量较大时，可以通过模块过滤来优化性能
- 定期清理 `uploads/` 目录下的临时文件

---

## 📚 更多信息

- 详细文档：查看 `README.md`
- 详细使用说明：查看 `使用说明.md`

---

**开始使用吧！** 🎉
