# Windows版本使用说明

## 重要：中文编码问题

**如果看到类似"'录' 不是内部或外部命令"的错误**，这是bat文件的中文编码问题。

### 推荐解决方案：使用英文文件名的启动脚本

- **`start_debug.bat`** - 调试模式（推荐首次使用）
- **`start.bat`** - 简单启动模式

这些文件使用纯ASCII字符，在所有Windows系统上都能正常工作。

## 问题：窗口一闪而过

如果Windows版本打开后窗口一闪而过，这通常是程序启动时遇到错误。

### 解决方案

#### 方法1：使用调试模式启动（推荐，兼容性最好）

1. 找到解压后的文件夹
2. **双击运行 `start_debug.bat`**（英文文件名，推荐）
   或 `调试模式启动.bat`（中文文件名，可能有编码问题）
3. 该脚本会：
   - 显示详细的启动信息
   - 捕获错误信息
   - 显示错误代码和可能的原因
   - 在程序退出后暂停，不会立即关闭窗口
   - 提供查看日志文件的选项

#### 方法2：使用普通启动脚本

1. 双击运行 `start.bat`（英文，推荐）
   或 `启动.bat`（中文，可能有编码问题）
2. 这个脚本会在程序退出后暂停，显示"按任意键继续..."

#### 方法3：通过命令行启动

1. 按 `Win + R` 打开运行对话框
2. 输入 `cmd` 并回车
3. 使用 `cd` 命令切换到程序目录，例如：
   ```cmd
   cd C:\Users\YourName\Downloads\excel-draw-tool
   ```
4. 运行程序：
   ```cmd
   excel-draw-tool.exe
   ```
5. 查看错误信息（如果有）

## 常见问题和解决方法

### 0. 中文编码错误（最常见）

**症状**：提示"'录' 不是内部或外部命令"或其他乱码

**原因**：Windows批处理文件的中文编码问题

**解决方法**：
- ✅ **使用英文文件名的启动脚本**：`start.bat` 或 `start_debug.bat`
- 这些文件使用纯ASCII字符，完全避免编码问题
- 功能与中文版完全相同，只是文件名和显示内容为英文

### 1. 端口被占用

**症状**：提示"端口 5000 已被占用"

**解决方法**：
- 程序会自动尝试使用 5001-5009 端口
- 如果所有端口都被占用，请关闭占用端口的其他程序
- 可以使用命令查看占用端口的程序：
  ```cmd
  netstat -ano | findstr :5000
  ```

### 2. 缺少文件或目录

**症状**：提示找不到某些文件

**解决方法**：
- 确保完整解压了 zip 文件，不要遗漏任何文件
- 确保以下文件/目录存在：
  - `excel-draw-tool.exe` - 主程序
  - `start.bat` / `start_debug.bat` - 英文启动脚本（推荐）
  - `templates/` - HTML模板目录
  - `static/` - 静态资源目录（包含ECharts库）
  - `sample_defect_data.xlsx` - 示例数据文件

### 3. 防火墙或安全软件阻止

**症状**：防火墙弹出警告

**解决方法**：
- 点击"允许访问"
- 或者在Windows防火墙中添加程序例外

### 4. 权限不足

**症状**：无法创建日志文件或临时文件

**解决方法**：
- 以管理员身份运行程序：
  1. 右键点击 `excel-draw-tool.exe` 或 `start_debug.bat`（推荐）
  2. 选择"以管理员身份运行"

## 查看日志

程序会在 `logs` 目录下创建日志文件：
- 日志文件名格式：`app_YYYYMMDD_HHMMSS.log`
- 每次启动都会创建新的日志文件
- 日志包含详细的错误信息和调试信息

**如何查看日志**：
1. 打开 `logs` 目录
2. 找到最新的日志文件（按修改时间排序）
3. 用记事本打开查看

或者使用"调试模式启动.bat"，退出时可以选择直接查看最新日志。

## 正常启动流程

程序正常启动后会：
1. 显示启动信息
2. 检查端口可用性
3. 启动Web服务器
4. 自动打开默认浏览器
5. 在浏览器中显示操作界面

**访问地址**：`http://localhost:5000`（如果5000被占用，会使用其他端口）

## 手动打开浏览器

如果浏览器没有自动打开：
1. 查看命令行窗口中的提示
2. 找到类似 `访问地址: http://localhost:5000` 的信息
3. 手动复制地址到浏览器打开

## 停止程序

- 在命令行窗口中按 `Ctrl + C`
- 或直接关闭命令行窗口

## 技术支持

如果以上方法都无法解决问题：
1. 运行"调试模式启动.bat"
2. 查看 `logs` 目录下的最新日志文件
3. 将错误信息和日志内容反馈给技术支持

## 系统要求

- Windows 7 或更高版本
- 需要能够访问本地网络（localhost）
- 建议至少 2GB 可用内存
- 不需要安装Python或其他依赖
- 支持完全离线使用

